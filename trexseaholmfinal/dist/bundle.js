(()=>{"use strict";var t={472(t,e,n){n.d(e,{A:()=>s});var i=n(645),r=n.n(i),o=n(278),a=n.n(o)()(r());a.push([t.id,"/* Style for \"Tap To Place Model\" text overlay */\n.over {\n  z-index: 10;\n  pointer-events: none;\n  position: absolute;\n  top: 0;\n  left: 0;\n  bottom: 0;\n  right: 0;\n\n  text-align: center;\n  color: white;\n  font-family: 'Nunito', monospace;\n  text-shadow: 0px 0px 5px black;\n}\n#promptText {\n  font-size: 1.8em;\n  bottom: 12vh;\n  position: absolute;\n  left: 50%;\n  transform: translate(-50%, 0);\n  width: 80vw; /* Allow up to 80% of screen width */\n  max-width: 1000px; /* Optional: limit on large screens */\n  white-space: normal; /* Allow wrapping if needed */\n  text-align: center; /* Keep text centered */\n}\n\n#captionText {\n  font-size: 1.8em;\n  bottom: 12vh;\n  position: absolute;\n  left: 50%;\n  transform: translate(-50%, 0);\n  width: 80vw; /* Allow up to 80% of screen width */\n  max-width: 1000px; /* Optional: limit on large screens */\n  white-space: normal; /* Allow wrapping if needed */\n  text-align: center; /* Keep text centered */\n}\n",""]);const s=a},278(t){t.exports=function(t){var e=[];return e.toString=function(){return this.map(function(e){var n="",i=void 0!==e[5];return e[4]&&(n+="@supports (".concat(e[4],") {")),e[2]&&(n+="@media ".concat(e[2]," {")),i&&(n+="@layer".concat(e[5].length>0?" ".concat(e[5]):""," {")),n+=t(e),i&&(n+="}"),e[2]&&(n+="}"),e[4]&&(n+="}"),n}).join("")},e.i=function(t,n,i,r,o){"string"==typeof t&&(t=[[null,t,void 0]]);var a={};if(i)for(var s=0;s<this.length;s++){var c=this[s][0];null!=c&&(a[c]=!0)}for(var l=0;l<t.length;l++){var u=[].concat(t[l]);i&&a[u[0]]||(void 0!==o&&(void 0===u[5]||(u[1]="@layer".concat(u[5].length>0?" ".concat(u[5]):""," {").concat(u[1],"}")),u[5]=o),n&&(u[2]?(u[1]="@media ".concat(u[2]," {").concat(u[1],"}"),u[2]=n):u[2]=n),r&&(u[4]?(u[1]="@supports (".concat(u[4],") {").concat(u[1],"}"),u[4]=r):u[4]="".concat(r)),e.push(u))}},e}},645(t){t.exports=function(t){return t[1]}},292(t){var e=[];function n(t){for(var n=-1,i=0;i<e.length;i++)if(e[i].identifier===t){n=i;break}return n}function i(t,i){for(var o={},a=[],s=0;s<t.length;s++){var c=t[s],l=i.base?c[0]+i.base:c[0],u=o[l]||0,p="".concat(l," ").concat(u);o[l]=u+1;var d=n(p),f={css:c[1],media:c[2],sourceMap:c[3],supports:c[4],layer:c[5]};if(-1!==d)e[d].references++,e[d].updater(f);else{var m=r(f,i);i.byIndex=s,e.splice(s,0,{identifier:p,updater:m,references:1})}a.push(p)}return a}function r(t,e){var n=e.domAPI(e);return n.update(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap&&e.supports===t.supports&&e.layer===t.layer)return;n.update(t=e)}else n.remove()}}t.exports=function(t,r){var o=i(t=t||[],r=r||{});return function(t){t=t||[];for(var a=0;a<o.length;a++){var s=n(o[a]);e[s].references--}for(var c=i(t,r),l=0;l<o.length;l++){var u=n(o[l]);0===e[u].references&&(e[u].updater(),e.splice(u,1))}o=c}}},383(t){var e={};t.exports=function(t,n){var i=function(t){if(void 0===e[t]){var n=document.querySelector(t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(t){n=null}e[t]=n}return e[t]}(t);if(!i)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");i.appendChild(n)}},88(t){t.exports=function(t){var e=document.createElement("style");return t.setAttributes(e,t.attributes),t.insert(e,t.options),e}},884(t,e,n){t.exports=function(t){var e=n.nc;e&&t.setAttribute("nonce",e)}},893(t){t.exports=function(t){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var e=t.insertStyleElement(t);return{update:function(n){!function(t,e,n){var i="";n.supports&&(i+="@supports (".concat(n.supports,") {")),n.media&&(i+="@media ".concat(n.media," {"));var r=void 0!==n.layer;r&&(i+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),i+=n.css,r&&(i+="}"),n.media&&(i+="}"),n.supports&&(i+="}");var o=n.sourceMap;o&&"undefined"!=typeof btoa&&(i+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(o))))," */")),e.styleTagTransform(i,t,e.options)}(e,t,n)},remove:function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(e)}}}},997(t){t.exports=function(t,e){if(e.styleSheet)e.styleSheet.cssText=t;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(t))}}}},e={};function n(i){var r=e[i];if(void 0!==r)return r.exports;var o=e[i]={id:i,exports:{}};return t[i](o,o.exports,n),o.exports}n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var i in e)n.o(e,i)&&!n.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.nc=void 0;var i=n(292),r=n.n(i),o=n(893),a=n.n(o),s=n(383),c=n.n(s),l=n(884),u=n.n(l),p=n(88),d=n.n(p),f=n(997),m=n.n(f),h=n(472),v={};function y(t){return y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},y(t)}function b(t,e,n){return(e=function(t){var e=function(t){if("object"!=y(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=y(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==y(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function g(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,i)}return n}v.styleTagTransform=m(),v.setAttributes=u(),v.insert=c().bind(null,"head"),v.domAPI=a(),v.insertStyleElement=d(),r()(h.A,v),h.A&&h.A.locals&&h.A.locals;var x={schema:{min:{default:6},max:{default:10}},init:function(){var t=this,e=document.getElementById("ground");this.prompt=document.getElementById("promptText");var n=document.getElementById("camera"),i=new THREE.Vector3;n.object3D.getWorldPosition(i);var r=!1;e.addEventListener("click",function(e){if(!r){r=!0,t.prompt.style.display="none";var n=document.createElement("a-entity"),o=document.createElement("a-entity"),a=(document.getElementById("trexModel"),e.detail.intersection.point),s=function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?g(Object(n),!0).forEach(function(e){b(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):g(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}({},a);s.y+=10,s.z+=8,s.x+=2,n.setAttribute("position",s),o.setAttribute("position",a);var c=i.x-a.x,l=i.z-a.z,u=Math.atan2(c,l)*(180/Math.PI);n.setAttribute("rotation","0 ".concat(u," 0")),o.setAttribute("rotation","0 ".concat(u," 0")),n.setAttribute("visible","false"),n.setAttribute("scale","0.0001 0.0001 0.0001"),o.setAttribute("scale","0.0001 0.0001 0.0001"),o.setAttribute("visible","false"),n.setAttribute("gltf-model","#birdModel"),n.setAttribute("animation-mixer",""),o.setAttribute("gltf-model","#trexModel"),o.setAttribute("animation-mixer",""),o.setAttribute("anim-controller",""),o.setAttribute("sound",{src:"#trexSound",autoplay:!0,positional:!0,volume:5}),t.el.sceneEl.appendChild(n),t.el.sceneEl.appendChild(o),n.addEventListener("model-loaded",function(){n.setAttribute("visible","true"),n.setAttribute("animation",{property:"scale",to:"".concat(4," ").concat(4," ").concat(4),easing:"easeOutElastic",dur:800})}),o.addEventListener("model-loaded",function(){o.setAttribute("visible","true"),o.setAttribute("animation",{property:"scale",to:"".concat(58," ").concat(58," ").concat(58),easing:"easeOutElastic",dur:800}),o.setAttribute("sound",{})}),o.dispatchEvent(new CustomEvent("trex-added",{bubbles:!0}))}})}},A={schema:{mixerId:{type:"string",default:""}},init:function(){var t=this;this.previousClip=null,this.action=null,this.mixer=null,this.clips=[],this.availableClipNames=[],this.el.addEventListener("model-loaded",function(){t.setupAnimations()})},setupAnimations:function(){var t=this.el.getObject3D("mesh");t&&(this.mixer=new THREE.AnimationMixer(t),this.clips=this.el.components["gltf-model"].model.animations,this.availableClipNames=this.clips.map(function(t){return t.name}),console.log("Available clips:",this.availableClipNames),this.playRandomClip())},playRandomClip:function(){var t=this;if(this.clips&&0!==this.clips.length&&this.mixer){var e;do{var n;e=this.clips[Math.floor(Math.random()*this.clips.length)]}while(e.name===(null===(n=this.previousClip)||void 0===n?void 0:n.name));this.previousClip=e,console.log("Playing animation clip:",e.name);var i=this.mixer.clipAction(e);i.reset(),i.setLoop(THREE.LoopRepeat,2),i.clampWhenFinished=!0,this.action&&(i.crossFadeFrom(this.action,.4,!1),this.action.stop()),i.play(),this.action=i,this.mixer.removeEventListener("finished",this._onFinish),this._onFinish=function(e){return t.onAnimationFinished(e)},this.mixer.addEventListener("finished",this._onFinish)}},onAnimationFinished:function(t){var e,n=this;t.action.getClip().name===(null===(e=this.previousClip)||void 0===e?void 0:e.name)&&(this.mixer.removeEventListener("finished",this.onAnimationFinished.bind(this)),setTimeout(function(){return n.playRandomClip()},400))},tick:function(t,e){this.mixer&&this.mixer.update(e/1e3)},remove:function(){this.mixer&&(this.mixer.stopAllAction(),this.mixer.removeEventListener("finished",this._onFinish))}};function E(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=Array(e);n<e;n++)i[n]=t[n];return i}var w={schema:{script:{type:"string",default:"Default message"},duration:{type:"number"},chunkSize:{type:"int",default:7},audioId:{type:"string"},textId:{type:"string"}},init:function(){var t=this;this.currentCaptionIndex=0,this.captionController=document.getElementById("captionController");var e=this.captionController.getAttribute("info"),n=this.captionController.getAttribute("captions");if(e&&n){var i,r,o=n.script,a="string"==typeof e?(r={},"string"!=typeof(i=e)?(console.warn("Expected a string but got:",y(i)),r):(i.split(";").forEach(function(t){var e,n,i=(e=t.split(":").map(function(t){return t.trim()}),n=2,function(t){if(Array.isArray(t))return t}(e)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var i,r,o,a,s=[],c=!0,l=!1;try{if(o=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;c=!1}else for(;!(c=(i=o.call(n)).done)&&(s.push(i.value),s.length!==e);c=!0);}catch(t){l=!0,r=t}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw r}}return s}}(e,n)||function(t,e){if(t){if("string"==typeof t)return E(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?E(t,e):void 0}}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),o=i[0],a=i[1];o&&a&&(r[o]=a)}),r)):e||{};if(a){var s=parseInt(a.chunkSize,10)||6,c=parseFloat(a.duration)||0;if(this.captionText=document.getElementById(a.textId),this.captionText){var l=o.split(" "),u=Math.ceil(l.length/s),p=c/u*1;this.captions=[];for(var d=0;d<u;d++){var f=d*p,m=l.slice(d*s,(d+1)*s).join(" ");this.captions.push({time:f,text:m})}this.el.sceneEl.addEventListener("trex-added",function(e){var n=e.target;n&&n.components.sound&&t.setupSound(n)}),this.checkSoundEntityInterval=setInterval(function(){var e=document.querySelector('[sound][gltf-model="#trexModel"]');e&&e.components.sound&&(clearInterval(t.checkSoundEntityInterval),t.setupSound(e))},100)}else console.error("[captions] Couldn't find text entity: textId=".concat(a.textId))}else console.error("info data not found")}else console.error("Caption data or raw info not found")},setupSound:function(t){var e=this;t.addEventListener("sound-loaded",function(){e.audio=t.components.sound.pool.children[0],e.audioReady=!0,e.audio.addEventListener("play",function(){e.audioReady=!0})})},tick:function(){if(this.audioReady&&this.audio&&this.captionText&&!(this.currentCaptionIndex>=this.captions.length)){var t=this.audio.context,e=this.audio._startedAr||0,n=t.currentTime-e,i=this.captions[this.currentCaptionIndex];n>=i.time&&(this.captionText.textContent=i.text,this.currentCaptionIndex++)}}};AFRAME.registerComponent("tap-place",x),AFRAME.registerComponent("anim-controller",A),AFRAME.registerComponent("clips",A),AFRAME.registerComponent("caption-comp",w),AFRAME.registerComponent("captions",w),AFRAME.registerComponent("info",{schema:{duration:{type:"number"},chunkSize:{type:"int",default:6},audioId:{type:"string"},textId:{type:"string"}}})})();